!function(e){var t={url:"timeline-events.json",showCount:2,loadCount:1,animation:!1,speed:600,line:"4px solid #d2d2d2"};e.fn.xmtimeline=function(s){if(0==this.length)return this;var a={},i=this,n=[],d=0,r=["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],l=["January","February","March","April","May","June","July","August","September","October","Novemeber","December"],c=function(){a.settings=e.extend({},t,s),i.addClass("xmtimeline"),o()},o=function(){e.ajax({url:a.settings.url,dataType:"json",contentType:"application/json",success:v})},u=function(){var e=n[d].date.day,t=n[d].date.month,s=n[d].date.year,a=new Date(s,t-1,e);return e+=p(e),[r[a.getDay()],l[t-1],e]},p=function(e){if(e>3&&21>e)return"th";switch(e%10){case 1:return"st";case 2:return"nd";case 3:return"rd";default:return"th"}},v=function(e){n=e,b(a.settings.showCount)},h=function(){return n.length>d},m=function(){e(".xmtimeline .event").each(function(){var t=e(this).offset().top+e(this).outerHeight()/3,s=e(window).scrollTop()+e(window).height();s>t&&g(e(this))})},f=function(e){switch(a.settings.animation){case"fade":e.css("visibility","hidden"),e.css("opacity",0);break;case"slide":case"scale":e.css("opacity",0)}},g=function(e){switch(a.settings.animation){case"fade":e.css("visibility","visible"),e.animate({opacity:1},a.settings.speed);break;case"slide":e.hasClass("left")&&e.addClass("slide-l"),e.hasClass("right")&&e.addClass("slide-r");break;case"scale":e.addClass("scale");break;case!1:return}},y=function(){var t=e("<div>",{"class":"loader"});t.text("Load More"),h()?t.bind("click",function(){e(this).remove(),b(a.settings.loadCount)}):t.text("No More Events").addClass("end"),i.append(t)},b=function(e){var t=n.length-d;t>e&&(t=e);for(var s=0;t>s;s++)C();m(),y()},C=function(){x();var t=e("<div>");t.css("clear","both");var s=e("<div>",{"class":"column-wrap"}),r=e("<div>",{"class":"column left"}),l=e("<div>",{"class":"column right"});r.css("borderRight",a.settings.line),s.append(r,l),i.append(s);for(var c,o=n[d].events.length,u=!0,p=!0,v=0;o>v;v++){var h=n[d].events[v],m=e("<div>",{"class":"event"}),g=e("<div>",{"class":"bullet "+h.bullet}),y=e("<div>",{"class":"time"}),b=e("<div>",{"class":"arrow"}),C=e("<div>",{"class":"body"}),w=e("<div>",{"class":"content"});f(m),u&&(c=h.side,u=!1),h.side!=c&&p&&(m.addClass("first"),p=!1);var M=e("<div>",{"class":"value"}),j=h.time.minutes;0==j&&(j="00"),h.time.am&&M.text(h.time.hours+":"+j+" AM"),h.time.pm&&M.text(h.time.hours+":"+j+" PM"),y.append(M),y.append(g),"left"==h.side&&b.addClass("right"),"right"==h.side&&b.addClass("left"),y.append(b);var k=!1;h.image&&(k='<img src="'+h.image+'" alt="event-image">'),h.video&&(k=h.video),C.append(k);for(var T=0;T<h.items.length;T++){var A=e("<h5>",{"class":"title"}),D=e("<h6>",{"class":"subtitle"}),J=e("<p>",{"class":"description"});A.text(h.items[T].title),w.append(A),D.text(h.items[T].subtitle),w.append(D),h.items[T].description&&(J.text(h.items[T].description),w.append(J)),C.append(w)}m.append(y,C),"left"==h.side?(m.addClass("left"),r.append(m)):"right"==h.side&&(m.addClass("right"),l.append(m))}i.append(t),d++},x=function(){var t=u(),s=e("<div>",{"class":"date"});s.text(t[0]+", "+t[1]+" "+t[2]),i.append(s)};return c(),e(document).bind("scroll",m),this}}(jQuery);